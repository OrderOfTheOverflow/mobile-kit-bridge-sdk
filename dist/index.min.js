"use strict";function __rest(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&(r[n[a]]=e[n[a]])}return r}function createSubscription(e){let t=!1;return{isUnsubscribed:()=>t,unsubscribe:()=>{t||(e(),t=!0)}}}function createDataStream(e){return{subscribe:e,then:(t,r)=>new Promise(()=>{try{let n=null,a=!1;n=e({next:e=>{t&&t(e),n&&n.unsubscribe(),a=!0}}),a&&n&&n.unsubscribe()}catch(e){r&&r(e)}})}}function getObjectKeys(e){return[...Object.keys(e),...Object.getOwnPropertyNames(Object.getPrototypeOf(e))]}function getCallbackName({moduleName:e,funcName:t,requestID:r}){return`${e}_${t}Callback${null!==r?`_${r}`:""}`}function isType(e,...t){if(!e)return!1;const r=getObjectKeys(e);return t.every(e=>r.indexOf(e)>=0)}function wrapModuleName(e){return`Wrapped${e}`}function streamCallback(e,{callbackNameFunc:t,funcToWrap:r}){return createDataStream(n=>{const a=t();let c;return e[a]=(e=>{if(isType(e,"status_code"))if(isType(e.result,"event"))switch(e.result.event){case exports.StreamEvent.STREAM_TERMINATED:c.unsubscribe()}else n&&n.next&&n.next(e)}),r(a),c=createSubscription(()=>{delete e[a],n&&n.complete&&n.complete()})})}function simplifyCallback(e,t){return streamCallback(e,__rest(t,["funcNameToWrap"]))}function wrapGenericModule(e,t,r){const n={};return{invoke:(a,c)=>simplifyCallback(e,{funcNameToWrap:a,callbackNameFunc:()=>{const e=n[a]||0;return n[a]=e+1,getCallbackName({moduleName:t,requestID:e,funcName:a})},funcToWrap:e=>r({callback:e,method:a,parameters:null!=c?c:{}})})}}function wrapModule(e,t){e[wrapModuleName(t)]=wrapGenericModule(e,t,r=>{if(e[t])e[t][r.method](JSON.stringify(r));else{if(!(e.webkit&&e.webkit.messageHandlers&&e.webkit.messageHandlers[t]))throw new Error(`Unexpected method '${r.method}' for module '${t}'`);e.webkit.messageHandlers[t].postMessage(r)}})}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.StreamEvent||(exports.StreamEvent={})).STREAM_TERMINATED="STREAM_TERMINATED",exports.wrapModule=wrapModule;