"use strict";function promisifyCallback(e,{callbackName:a,funcToWrap:t}){return new Promise(r=>{e[a]=(e=>r(e)),t()})}function __rest(e,a){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&a.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(r=Object.getOwnPropertySymbols(e);n<r.length;n++)a.indexOf(r[n])<0&&(t[r[n]]=e[r[n]])}return t}function setupGlobal(e,{callbackNameFunc:a}){const t=a(null);e[t]||(e[t]=(t=>{var{requestID:r}=t,n=__rest(t,["requestID"]);const l=a(r);e[l]&&e[l](n),delete e[l]}))}function getModuleKeys(e){return[...Object.keys(e),...Object.getOwnPropertyNames(Object.getPrototypeOf(e))]}function getCallbackName({moduleName:e,funcName:a,requestID:t}){return`${e}_${a}Callback${null!==t?`_${t}`:""}`}function wrapAndroidModule(e,a,t){const r=getModuleKeys(t).filter(e=>"function"==typeof t[e]).map(r=>{let n=0;const l=e=>getCallbackName({moduleName:a,requestID:e,funcName:r});return setupGlobal(e,{callbackNameFunc:l}),{[r]:(...a)=>{const o=`${n}`;return n+=1,promisifyCallback(e,{callbackName:l(o),funcToWrap:t[r].bind(t,o,...a,l(null))})}}}).reduce((e,a)=>Object.assign({},e,a),{});return{invoke:(e,...a)=>r[e](...a.map(({paramValue:e})=>e))}}function wrapIOSModule(e,a,t){const r={};return{invoke:(n,...l)=>{const o=(r[n]||-1)+1;r[n]=o;const c=e=>getCallbackName({moduleName:a,requestID:e,funcName:n});setupGlobal(e,{callbackNameFunc:c});const u={method:n,parameters:Object.assign({},l.map(({paramName:e,paramValue:a})=>({[e]:a})).reduce((e,a)=>Object.assign({},e,a),{}),{requestID:o}),callbackName:c(null)};return promisifyCallback(e,{callbackName:c(o),funcToWrap:t.postMessage.bind(t,u)})}}}function wrapModule(e,a){if(e[a]){const t=e[a],r=wrapAndroidModule(window,a,t);e[a]=r}else if(e.webkit&&e.webkit.messageHandlers&&e.webkit.messageHandlers[a]){const t=wrapIOSModule(e,a,e.webkit.messageHandlers[a]);e[a]=t}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.wrapAndroidModule=wrapAndroidModule,exports.wrapIOSModule=wrapIOSModule,exports.wrapModule=wrapModule;