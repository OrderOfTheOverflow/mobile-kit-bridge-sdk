"use strict";function __rest(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&(r[n[a]]=e[n[a]])}return r}function createSubscription(e){let t=!1;return{isUnsubscribed:()=>t,unsubscribe:()=>{t||(e(),t=!0)}}}function getObjectKeys(e){return[...Object.keys(e),...Object.getOwnPropertyNames(Object.getPrototypeOf(e))]}function isStreamFunction(e){return e.toLowerCase().startsWith("observe")}function getCallbackName({moduleName:e,funcName:t,requestID:r}){return`${e}_${t}Callback${null!==r?`_${r}`:""}`}function isType(e,...t){const r=getObjectKeys(e);return t.every(e=>r.indexOf(e)>=0)}function promisifyCallback(e,{callbackNameFunc:t,funcToWrap:r}){const n=t();return new Promise(t=>{e[n]=(r=>{t(r),delete e[n]}),r(n)()})}function streamCallback(e,{callbackNameFunc:t,funcToWrap:r}){return{subscribe:n=>{const a=t();let o;return e[a]=(e=>{if(isType(e,"result","error","status_code"))n&&n.next&&n.next(e);else switch(e.event){case exports.StreamEvent.STREAM_TERMINATED:o.unsubscribe()}}),r(a)(),o=createSubscription(()=>{delete e[a],n&&n.complete&&n.complete()})}}}function simplifyCallback(e,t){var{funcNameToWrap:r}=t,n=__rest(t,["funcNameToWrap"]);return isStreamFunction(r)?streamCallback(e,n):promisifyCallback(e,n)}function wrapAndroidModule(e,t,r){const n=getObjectKeys(r).filter(e=>"function"==typeof r[e]).map(n=>{let a=0;const o=()=>{const e=`${a}`;return a+=1,getCallbackName({moduleName:t,requestID:e,funcName:n})};return{[n]:t=>simplifyCallback(e,{callbackNameFunc:o,funcNameToWrap:n,funcToWrap:e=>r[n].bind(r,{callback:e,method:n,parameters:t})})}}).reduce((e,t)=>Object.assign({},e,t),{});return{invoke:(e,t)=>n[e](t)}}function wrapIOSModule(e,t,r){const n={};return{invoke:(a,o)=>simplifyCallback(e,{funcNameToWrap:a,callbackNameFunc:()=>{const e=n[a]||0;return n[a]=e+1,getCallbackName({moduleName:t,requestID:e,funcName:a})},funcToWrap:e=>r.postMessage.bind(r,{callback:e,method:a,parameters:o})})}}function wrapModule(e,t){if(e[t]){const r=e[t],n=wrapAndroidModule(window,t,r);e[t]=n}else if(e.webkit&&e.webkit.messageHandlers&&e.webkit.messageHandlers[t]){const r=wrapIOSModule(e,t,e.webkit.messageHandlers[t]);e[t]=r}}Object.defineProperty(exports,"__esModule",{value:!0}),(exports.StreamEvent||(exports.StreamEvent={})).STREAM_TERMINATED="STREAM_TERMINATED",exports.wrapAndroidModule=wrapAndroidModule,exports.wrapIOSModule=wrapIOSModule,exports.wrapModule=wrapModule;