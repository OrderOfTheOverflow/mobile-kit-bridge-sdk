!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).bridgeSDK={})}(this,function(e){"use strict";function t(e,...t){const n=function(e){return[...Object.keys(e),...Object.getOwnPropertyNames(Object.getPrototypeOf(e))]}(e);return!!e&&t.every(e=>n.indexOf(e)>=0)}function n(n,{callbackNameFunc:r,funcToWrap:o}){return{subscribe:u=(u=>{const c=r();let s;return n[c]=(n=>{if(t(n,"status_code"))if(t(n.result,"event"))switch(n.result.event){case e.StreamEvent.STREAM_TERMINATED:s.unsubscribe()}else u&&u.next&&u.next(n)}),o(c),s=function(e){let t=!1;return{isUnsubscribed:()=>t,unsubscribe:()=>{t||(e(),t=!0)}}}(()=>{delete n[c],u&&u.complete&&u.complete()})}),then:e=>new Promise(()=>{const t=u({next:n=>{e&&e(n),t.unsubscribe()}})})};var u}function r(e,t){var{funcNameToWrap:r,isStream:o}=t,u=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(n[r[o]]=e[r[o]])}return n}(t,["funcNameToWrap","isStream"]);return o?n(e,u):function(e,{callbackNameFunc:t,funcToWrap:n}){const r=t();return new Promise(t=>{e[r]=(n=>{t(n),delete e[r]}),n(r)})}(e,u)}(e.StreamEvent||(e.StreamEvent={})).STREAM_TERMINATED="STREAM_TERMINATED",e.wrapModule=function(e,t){e[function(e){return`Wrapped${e}`}(t)]=function(e,t,n){const o={};return{invoke:(u,c)=>r(e,{funcNameToWrap:u,isStream:!!c&&!!c.isStream,callbackNameFunc:()=>{const e=o[u]||0;return o[u]=e+1,function({moduleName:e,funcName:t,requestID:n}){return`${e}_${t}Callback${null!==n?`_${n}`:""}`}({moduleName:t,requestID:e,funcName:u})},funcToWrap:e=>n({callback:e,method:u,parameters:null!=c?c:{}})})}}(e,t,n=>{e[t]?e[t][n.method](JSON.stringify(n)):e.webkit&&e.webkit.messageHandlers&&e.webkit.messageHandlers[t]&&e.webkit.messageHandlers[t].postMessage(n)})},Object.defineProperty(e,"__esModule",{value:!0})});